# Описание плейбука для развёртывания ELK

1. В качестве тестового стенда применяются три ВМ, которые разворачиваются при помощи Vagrant из бокса Ubuntu 20.04: `vagrant up`. Используется такой [Vagranfile](https://github.com/Protosuv/devops-netology/blob/master/myansible/playbook2/ELK/Vagrantfile).  
Каждая ВМ видит все остальные как по IP, так и по доменному имени. Для этого вносятся правки в файл `/etc/hosts` на каждой из ВМ. Взаимодействие между ВМ осуществляется через внутреннюю сеть класса C: `192.168.10.0/24`.
2. Предусмотрено копирование публичного ключа SSH в каждую из ВМ, для удобной работы с Ansible. Авторизация без пароля осуществляется под пользователем vagrant.
3. Инвентарь содержит общую группу `elk` в которой описаны все три ВМ с подключением по SSH.
4. Плейбук содержит несколько play для выполнения всех необходимых действий:
   - установка Java на все три ВМ, поскольку она требуется для работы приложений стека ELK;
   - установка Elasticsearch из архива .tar.gz на первую ВМ;
   - установка Kibana из архива .tar.gz на вторую ВМ;
   - установка Logstash из архива .tar.gz на третью ВМ.
5. Для того, чтобы запустить плейбук, нужно использовать команду находясь в корне проекта:  
   `ansible-playbook -i inventory/prod.yml site.yml`.
6. Плейбук содержит теги: `java, elastic, kibana, skip_ansible_lint, logstash`.
7. Используются шаблоны jinja конфигурационных файлов при настройке ВМ. Шаблоны размещены в [папке](https://github.com/Protosuv/devops-netology/tree/master/myansible/playbook2/templates). 
8. Архив Java размещается в папке `/files` проекта. Установка осуществляется из этого архива (вместо загрузки с сайта Oracle).  